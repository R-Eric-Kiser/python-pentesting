# https://systemweakness.com/python-penetration-testing-extracting-contact-information-from-outlook-2bac232b22a9
# Extract contact information from Outlook

import win32com.client

# Connect to the running instance of Outlook
outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")

# Get the default Contacts folder
contacts_folder = outlook.GetDefaultFolder(10)

# Get the address book folder
address_book_folder = outlook.GetDefaultFolder(11)

# Get the address book entries
address_book = address_book_folder.Items

# Loop through the items in the Contacts folder and extract the desired information
for contact in contacts_folder.Items:
    # Check if the contact has a full name
    if hasattr(contact, 'FullName'):
        full_name = contact.FullName
    else:
        continue  # Skip this contact if full name is not available
    
    # Extract the email address
    if hasattr(contact, 'Email1Address'):
        email_address = contact.Email1Address
    else:
        email_address = 'N/A'
    
    # Check if the contact has a phone number
    if hasattr(contact, 'BusinessTelephoneNumber'):
        phone_number = contact.BusinessTelephoneNumber
    else:
        phone_number = 'N/A'
    
    # Check if the contact has a department
    if hasattr(contact, 'Department'):
        department = contact.Department
    else:
        department = 'N/A'
    
    # Print the contact information to the screen
    print(f"Name: {full_name}")
    print(f"Email: {email_address}")
    print(f"Phone: {phone_number}")
    print(f"Department: {department}")
    print('-' * 20)

# Loop through the address book entries and extract the desired information
for entry in address_book:
    # Check if the entry is a contact
    if entry.AddressEntryUserType == 0:
        # Get the contact object
        contact = entry.GetContact()
        
        # Check if the contact has a full name
        if hasattr(contact, 'FullName'):
            full_name = contact.FullName
        else:
            continue  # Skip this contact if full name is not available
        
        # Extract the email address
        if hasattr(contact, 'Email1Address'):
            email_address = contact.Email1Address
        else:
            email_address = 'N/A'
        
        # Check if the contact has a phone number
        if hasattr(contact, 'BusinessTelephoneNumber'):
            phone_number = contact.BusinessTelephoneNumber
        else:
            phone_number = 'N/A'
        
        # Check if the contact has a department
        if hasattr(contact, 'Department'):
            department = contact.Department
        else:
            department = 'N/A'
        
        # Print the contact information to the screen
        print(f"Name: {full_name}")
        print(f"Email: {email_address}")
        print(f"Phone: {phone_number}")
        print(f"Department: {department}")
        print('-' * 20)
