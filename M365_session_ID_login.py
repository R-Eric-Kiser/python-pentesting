import requests
import webbrowser

# Define the Microsoft 365 API endpoint and headers
endpoint = 'https://graph.microsoft.com/v1.0/me'
headers = {'Authorization': 'Bearer <your session ID>'}

# Use the Requests library to make an API call to Microsoft 365
response = requests.get(endpoint, headers=headers)

# Check for a successful response
if response.status_code == 200:
    data = response.json()
    print('Session login successful for user:', data['userPrincipalName'])

    # Open Chrome with the session ID
    session_id = '<your session ID>'
    chrome_url = f'https://www.example.com?session={session_id}'  # Replace with the appropriate URL
    webbrowser.get('chrome').open(chrome_url)
else:
    print('Session login failed with error code:', response.status_code)
